---
title: "Hugo のヘッダーで相対参照がうまくいかない"
date: '2025-12-12'
showDate: true
url: 'no/l1fdylmjwj/'
aliases: '/aliases/2025-12-12/'
categories: ["Hugo"]
tags: ["相対参照"]
showTableOfContents: false
---

![text](img/feature-blog.png)

## Hugoの相対参照

Hugo の設定をしているとき，特にヘッダーを編集しているときに，いくらいじっても **相対参照が上手くいかない** 事態が発生した．

通常の記事中の参照 (例えば `[text](url)` のような形式) であれば， URL の ドメイン部分より後の部分を `url` 部分に書けばOKだった．
例えば参照したいページの URL が `localhost:1313/blog/` や `https://example.com/blog/` の場合， `[text](/blog/)` だけ書けば参照されて解決だった．これがヘッダー部分での参照だけはこのルールが適用されなかった．

## 前提の整理

今回使うファイルはページは以下のような構成になっている

```directory
.
├── config/
│   └── _default/
│       ├── menus.ja.toml
│       └── ....toml
└── content/
    └── 0-blog/
        ├── _index.md
        └── ....md
```

この `0-blog/` は探す手間を減らすためにわざわざ先頭に `0-` を付けたものである．（結果だけ言えば，これがよくなかった．）

Hugo の仕様上， `0-blog/` を参照するときには `_index.md` が参照されることになるが，その markdown のメタデータは次のようになっていた．

```markdown
---
# 0-blog/_index.md
title: "ブログ"
url: "blog/"
---
```

ヘッダーにメニューを追加する場合の設定ファイルを分割しており， `menus.ja.toml` に以下のように記載していた．

```toml
# config/_default/menus.ja.toml
[[main]]
name = "ブログ"
pageRef = "/blog/"
weight = 10
```

これでヘッダーに「ブログ」へのリンクが記載されるだろうと思って何度試しても，元のページにリダイレクトされるだけで何も起こらない虚無の時間が数時間発生した．

## 問題の究明と解決

今回の問題を整理すると次のようになる．

- 参照したい URL とディレクトリの名前が違うこと．(`0-blog` と `/blog/`)
- `pageRef` も通常の相対参照のように働くという勘違い．

結局，`menus.ja.toml` を以下のように修正することで解決した．

```toml
# config/_default/menus.ja.toml
[[main]]
name = "ブログ"
pageRef = "/0-blog/"
weight = 10
```

つまり， `pageRef` で相対参照したい場合，さらに言えば URL とディレクトリ名がズレている場合は，ディレクトリ名の方を入力する必要がある．

ちなみに，この状態でリンクを踏んでみるとちゃんと `https://example.com/blog/` になっているため，ページ遷移したあとは URL がちゃんと適用されるようになっている．
なら最初から相対パスでできるようになってほしい．

